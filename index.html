<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Content Strategist & Prompt Gen v17.0 (Strict Numbering)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a73e8;
            --border-color: #dadce0;
            --bg-color: #f8f9fa;
            --code-bg: #1e1e1e;
            --code-text: #d4d4d4;
            --text-color: #202124;
            --radius-input: 12px;
            --radius-container: 16px;
            --radius-btn: 50px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Google Sans', sans-serif;
            height: 100vh;
            color: var(--text-color);
            overflow: hidden;
            background: #fff;
        }

        .container { display: flex; height: 100vh; width: 100%; }

        /* --- LEFT: INPUT SECTION --- */
        .input-section {
            width: 480px;
            min-width: 350px;
            padding: 32px;
            overflow-y: auto;
            background: #fff;
            border-right: 1px solid var(--border-color);
        }

        .resizer {
            width: 8px;
            cursor: col-resize;
            background: #f1f3f4;
            transition: background 0.2s;
            border-left: 1px solid #ebebeb;
        }
        .resizer:hover { background: var(--primary-color); }

        /* --- RIGHT: OUTPUT SECTION --- */
        .output-section {
            flex: 1;
            padding: 32px;
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* TYPOGRAPHY */
        h2 { color: var(--text-color); font-size: 18px; margin-bottom: 20px; font-weight: 700; }
        
        .section-title { 
            font-size: 11px; font-weight: 800; color: #5f6368; 
            text-transform: uppercase; border-bottom: 2px solid #e8eaed; 
            padding-bottom: 5px; margin: 30px 0 15px; letter-spacing: 0.5px; 
        }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: 700; font-size: 13px; margin-bottom: 8px; color: #202124; }
        .helper { font-size: 11px; color: #666; margin-bottom: 6px; display: block; line-height: 1.4; }
        
        /* --- INPUT STYLING --- */
        input[type="text"], select, textarea {
            width: 100%; padding: 12px 16px; 
            border: 1px solid var(--border-color);
            border-radius: var(--radius-input);
            font-family: inherit; font-size: 13px;
            background: #fff;
            color: #3c4043;
            transition: border 0.2s, box-shadow 0.2s;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
            line-height: 1.5;
        }

        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23202124%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 16px top 50%;
            background-size: 10px auto;
        }

        input:focus, select:focus, textarea:focus { 
            outline: none; 
            border-color: var(--primary-color); 
            box-shadow: 0 0 0 4px rgba(26,115,232,0.1); 
        }
        
        select[multiple] { 
            height: 220px; padding: 8px; 
            background-image: none; 
        }
        select[multiple] option { padding: 10px; border-radius: 8px; margin-bottom: 2px; line-height: 1.4; }
        select[multiple] option:checked { background-color: #e8f0fe; color: #1967d2; font-weight: 700; }

        .custom-input { 
            margin-top: 10px; 
            display: block; 
            background: #fff;
            border-left: 1px solid var(--border-color) !important; 
        }
        .custom-input:focus { border-color: var(--primary-color) !important; }

        /* FILE UPLOAD STYLING */
        .file-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }
        input[type="file"] {
            font-size: 12px;
            padding: 8px;
            background: #f8f9fa;
            border: 1px dashed var(--border-color);
            border-radius: var(--radius-input);
            flex: 1;
        }
        .clear-btn {
            background: transparent;
            border: none;
            color: #202124; 
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            display: none; 
            align-items: center;
            justify-content: center;
            padding: 0 8px;
            transition: 0.2s;
        }
        .clear-btn:hover { color: #d93025; }
        .clear-btn.visible { display: flex; }

        /* VIEW TOGGLE */
        .view-toggle { 
            display: flex; background: #e8eaed; padding: 4px; 
            border-radius: var(--radius-btn);
            margin-bottom: 15px; width: fit-content; margin-left: auto; 
        }
        .view-btn { 
            padding: 8px 20px; border: none; background: transparent; 
            font-size: 12px; font-weight: 700; cursor: pointer; 
            border-radius: var(--radius-btn); color: #5f6368; transition: 0.2s;
        }
        .view-btn.active { background: #fff; color: var(--text-color); box-shadow: 0 2px 5px rgba(0,0,0,0.08); }

        /* OUTPUT BOX */
        .output-box {
            flex: 1;
            background: #fff;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-container);
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
            display: flex;
            flex-direction: column;
        }

        .brief-content { 
            padding: 30px; 
            line-height: 1.4; 
            font-size: 14px; 
            overflow-y: auto; 
            height: 100%;
        }
        
        /* --- STYLING OUTPUT --- */
        .brief-item { 
            display: flex; 
            border-bottom: 1px solid #f1f3f4; 
            padding: 12px 0; 
            align-items: flex-start; 
            justify-content: flex-start;
        }
        
        .brief-key { 
            font-weight: 700; 
            width: 160px; 
            color: #444; 
            flex-shrink: 0; 
            padding-right: 10px;
            margin: 0;
            line-height: 1.5; 
        }
        
        .brief-val { 
            color: #202124; 
            font-weight: 500; 
            flex: 1; 
            text-align: left !important; 
            white-space: pre-wrap; 
            margin: 0;
            line-height: 1.5;
        }
        
        /* DETAIL DIBAWAH FORMULA */
        .detail-block {
            display: block;
            margin-top: 4px; /* Tambah jarak sedikit agar jelas ini anak dari atasnya */
            padding-left: 0;
            border: none;
            color: #5f6368;
            font-size: 13px;
            white-space: pre-wrap;
            line-height: 1.5;
            text-align: left !important;
        }

        .prompt-content {
            background: var(--code-bg); color: var(--code-text);
            font-family: 'JetBrains Mono', monospace; font-size: 12px;
            padding: 25px; white-space: pre-wrap; line-height: 1.5;
            height: 100%; overflow-y: auto; display: none;
        }

        /* ACTION BAR */
        .action-bar { 
            margin-top: 15px; 
            display: flex; 
            justify-content: flex-start; 
        }
        .btn { 
            padding: 12px 28px; border: none; 
            border-radius: var(--radius-btn);
            font-weight: 600; cursor: pointer; font-size: 13px; 
            display: flex; align-items: center; gap: 8px; transition: 0.2s; 
        }
        .btn-primary { background: #202124; color: #fff; } 
        .btn-primary:hover { background: #3c4043; transform: translateY(-1px); }
        .btn.copied { background: #1a73e8 !important; color: #fff; }

        @media (max-width: 800px) {
            .container { flex-direction: column; }
            .input-section, .output-section { width: 100%; height: 50%; }
            .resizer { display: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LEFT INPUT -->
        <div class="input-section" id="leftPane">
            <h2>‚úèÔ∏è Input</h2>

            <!-- A. CORE -->
            <div class="section-title" style="margin-top:0">A. Context & Format</div>
            
            <div class="form-group">
                <label>1. Topic</label>
                <textarea id="topic" placeholder="e.g. 'Freelancing' -> 'Why 9-5 is actually safer'&#10;(Tekan Enter untuk baris baru)" style="min-height: 60px;"></textarea>
            </div>

            <div class="form-group">
                <label>2. Duration</label>
                <select id="duration">
                    <option value="15s">15s (Micro Hook)</option>
                    <option value="30s">30s (Micro Hook)</option>
                    <option value="1m" selected>1m (Shorts/Reels)</option>
                    <option value="90s">90s (Shorts/Reels)</option>
                    <option value="3m">3m (YouTube Standard)</option>
                    <option value="5m">5m (YouTube Standard)</option>
                    <option value="8m">8m (Deep Dive)</option>
                    <option value="10m">10m (Deep Dive)</option>
                    <option value="15m+">15m+ (Documentary)</option>
                    <option value="Custom">Custom Duration...</option>
                </select>
                <input type="text" id="durationCustom" class="custom-input" style="display:none" placeholder="Isi durasi manual...">
            </div>

            <div class="form-group">
                <label>3. Content Format / Media</label>
                <span class="helper">Pilih "Belum kepikiran" jika ingin AI yang menentukan.</span>
                <select id="format">
                    <option value="Undecided">‚ö†Ô∏è Belum kepikiran (Skip Output)</option>
                    <optgroup label="Video Formats">
                        <option value="Talking Head Video">Talking Head (Influencer/Face-cam)</option>
                        <option value="Faceless Stock Footage">Faceless + Stock Footage</option>
                        <option value="Cinematic Video">Cinematic (B-Roll + Voiceover)</option>
                        <option value="Kinetic Typography">Kinetic Typography (Text Only)</option>
                        <option value="Animation">Animation / Motion Graphics</option>
                        <option value="Mixed Media">Mixed (Face + Overlay)</option>
                        <option value="Screen Recording">Screen Recording / Tutorial</option>
                    </optgroup>
                    <optgroup label="Audio Only">
                        <option value="Audio Only / Podcast">Audio Only / Podcast (Spotify)</option>
                        <option value="Meditation Guide">Meditation / Sleep Guide</option>
                    </optgroup>
                    <optgroup label="Others">
                        <option value="Script Only">Script Only (General)</option>
                        <option value="Custom">Custom Format...</option>
                    </optgroup>
                </select>
                <input type="text" id="formatCustom" class="custom-input" style="display:none" placeholder="e.g. Carousel Text, Thread...">
            </div>

            <div class="form-group">
                <label>4. Language</label>
                <select id="language">
                    <option value="Indonesian">Indonesian</option>
                    <option value="English">English</option>
                    <option value="Mix (Indo-Eng)">Mix (Indo-Eng)</option>
                </select>
            </div>

            <div class="form-group">
                <label>5. Target Audience</label>
                <select id="audiencePreset">
                    <option value="">-- Pilih Preset atau Ketik Manual --</option>
                    <option value="Orang yang merasa stuck meski sudah kerja keras">Orang stuck meski kerja keras</option>
                    <option value="Pemula yang ingin hasil cepat tanpa modal besar">Pemula ingin hasil instan</option>
                    <option value="Gen Z / Internet Native">Gen Z / Youth (Santai/Gaul)</option>
                    <option value="General Public / Household / Lifestyle">General Public (Ibu-ibu/Hobi/Umum)</option>
                    <option value="Professionals / Business Owners">Professionals (Formal/Serious)</option>
                    <option value="Skeptics who doubt mainstream advice">Skeptis terhadap saran umum</option>
                    <option value="Custom">Lainnya (Ketik Manual)...</option>
                </select>
                <input type="text" id="audienceCustom" class="custom-input" placeholder="Deskripsi spesifik audience...">
            </div>

            <!-- B. VOICE & TONE -->
            <div class="section-title">B. Voice & Style</div>

            <div class="form-group">
                <label>6. Voice Base (Speaker) <span style="font-weight:400; font-size:11px; color:#1a73e8">(Multi-select: Hold Ctrl/Cmd)</span></label>
                <select id="voiceBase" multiple>
                    <option value="HYPE">HYPE - High Energy</option>
                    <option value="SNAPPY">SNAPPY - Fast Paced</option>
                    <option value="DOCUMENTARY">DOCUMENTARY - Serious</option>
                    <option value="THRILLER">THRILLER - Suspenseful</option>
                    <option value="EDUCATIONAL">EDUCATIONAL - Clear Teacher</option>
                    <option value="PHILANTHROPY">PHILANTHROPY - Emotional/Kind</option>
                    <option value="POETIC">POETIC - Deep & Metaphorical</option>
                    <option value="CORPORATE">CORPORATE - Professional</option>
                    <option value="CASUAL">CASUAL - Conversational</option>
                    <option value="ARTISTIC">ARTISTIC - Creative Flow</option>
                    <option value="CINEMATIC">CINEMATIC - Movie Trailer</option>
                    <option value="SPIRITUAL">SPIRITUAL - Calm & Zen</option>
                    <option value="LORE">LORE - Storyteller</option>
                    <option value="STREET">STREET - Raw & Urban</option>
                    <option value="ANCHOR">ANCHOR - News Authority</option>
                    <option value="HERO">HERO - Epic Motivational</option>
                    <option value="BUSINESS">BUSINESS - Data Driven</option>
                    <option value="MASCOT">MASCOT - Playful Character</option>
                    <option value="SCI-FI">SCI-FI - Futuristic Tech</option>
                </select>
                <input type="text" id="voiceCustom" class="custom-input" placeholder="+ Tambahkan gaya suara custom (opsional)...">
            </div>

            <div class="form-group">
                <label>7. Tone Flavor (Emotion) <span style="font-weight:400; font-size:11px; color:#1a73e8">(Multi-select: Hold Ctrl/Cmd)</span></label>
                <select id="toneFlavor" multiple>
                    <option value="Classic">Classic: Standar, formal, jelas, profesional</option>
                    <option value="GenZ">GenZ: Slang internet (No cap, Slay, Bet)</option>
                    <option value="Conversational">Conversational: Natural (Aku/Kamu)</option>
                    <option value="Emotional">Emotional: Penuh perasaan & menyentuh hati</option>
                    <option value="Humor">Humor: Santai, lucu, memancing tawa</option>
                    <option value="Dramatic">Dramatic: Teatral, berlebihan, penuh aksi</option>
                    <option value="Dark">Dark: Suram, sinis, humor hitam</option>
                    <option value="Serious">Serious: Tegas, sungguh-sungguh</option>
                    <option value="Comic">Comic: Ringan, jenaka, kartun</option>
                    <option value="Sarcastic">Sarcastic: Nada sindiran/ejekan lucu</option>
                    <option value="Aggressive">Aggressive: Menekan & konfrontatif</option>
                    <option value="Wholesome">Wholesome: Positif, hangat, family friendly</option>
                    <option value="Melancholic">Melancholic: Sedih, reflektif, sendu</option>
                    <option value="Urgent">Urgent: Terburu-buru ("Breaking News")</option>
                    <option value="Inspirational">Inspirational: Menggugah semangat</option>
                    <option value="Whimsical">Whimsical: Aneh, unik, ajaib</option>
                    <option value="Suspense">Suspense: Menegangkan</option>
                    <option value="Motivational">Motivational: Mendorong tindakan</option>
                    <option value="ASMR-Soft">ASMR-Soft: Berbisik, lembut</option>
                    <option value="Cinematic-Epic">Cinematic-Epic: Kolosal, megah</option>
                    <option value="Bold-Corporate">Bold-Corporate: Percaya diri bisnis</option>
                    <option value="Philosophical">Philosophical: Berpikir mendalam</option>
                </select>
                <input type="text" id="toneCustom" class="custom-input" placeholder="+ Tambahkan tone custom (opsional)...">
            </div>

            <!-- C. STRATEGY -->
            <div class="section-title">C. Strategy & Formula</div>

            <div class="form-group">
                <label>8. Story Formula</label>
                <select id="storyFormula">
                    <optgroup label="Standard & Viral">
                        <option value="WOW‚ÄìHOW‚ÄìNOW">WOW‚ÄìHOW‚ÄìNOW (Viral hook)</option>
                        <option value="Before‚ÄìAfter‚ÄìWhy">Before‚ÄìAfter‚ÄìWhy (Transformation)</option>
                        <option value="Problem‚ÄìAction‚ÄìResult">Problem‚ÄìAction‚ÄìResult (Classic)</option>
                        <option value="Myth‚ÄìFact‚ÄìLesson">Myth‚ÄìFact‚ÄìLesson (Debunk)</option>
                        <option value="Hook‚ÄìProof‚ÄìPromise">Hook‚ÄìProof‚ÄìPromise (High Conversion)</option>
                        <option value="Top-X Curiosity Loop">Top-X Curiosity Loop (Listicle)</option>
                    </optgroup>
                    
                    <optgroup label="Narrative & Emotional">
                        <option value="RANT / OPINION">RANT / OPINION (Raw Opinion)</option>
                        <option value="Twist‚ÄìReveal‚ÄìReflect">Twist‚ÄìReveal‚ÄìReflect (Surprise)</option>
                        <option value="Fact‚ÄìEmotion‚ÄìHope">Fact‚ÄìEmotion‚ÄìHope (Non-Profit)</option>
                        <option value="Vision‚ÄìObstacle‚ÄìBreakthrough">Vision‚ÄìObstacle‚ÄìBreakthrough (Founder)</option>
                        <option value="Fear‚ÄìAvoid‚ÄìAchieve">Fear‚ÄìAvoid‚ÄìAchieve (Solving)</option>
                        <option value="Contrast‚ÄìPain‚ÄìChange">Contrast‚ÄìPain‚ÄìChange (Visual)</option>
                        <option value="OneName‚ÄìOneIdea‚ÄìOneChange">OneName‚ÄìOneIdea‚ÄìOneChange (Profile)</option>
                    </optgroup>

                    <optgroup label="Deep & Mystery">
                        <option value="Mystery‚ÄìClue‚ÄìTruth">Mystery‚ÄìClue‚ÄìTruth (Detective)</option>
                        <option value="Question‚ÄìChase‚ÄìAnswer">Question‚ÄìChase‚ÄìAnswer (Journey)</option>
                        <option value="Chaos‚ÄìOrder‚ÄìPurpose">Chaos‚ÄìOrder‚ÄìPurpose (Philosophy)</option>
                        <option value="Pattern‚ÄìBreak‚ÄìImpact">Pattern‚ÄìBreak‚ÄìImpact (Analysis)</option>
                        <option value="TinyDetail‚ÄìBigTruth‚ÄìCuriosity">TinyDetail‚ÄìBigTruth‚ÄìCuriosity (Essay)</option>
                        <option value="HiddenOrigin‚ÄìModernImpact‚ÄìHumanMeaning">HiddenOrigin‚ÄìImpact‚ÄìMeaning (Lore)</option>
                    </optgroup>
                </select>
                
                <!-- PLACEHOLDER SESUAI REQUEST -->
                <textarea id="formulaDetail" class="custom-input" style="display:block; margin-top:10px; border-left:1px solid var(--border-color) !important; min-height:80px;" placeholder="+ Add detail (Opsional)"></textarea>
            </div>

            <div class="form-group">
                <label>9. Call to Action (CTA)</label>
                <span class="helper">Kosongkan jika tidak ingin ada CTA di output (urutan akan naik).</span>
                <input type="text" id="cta" placeholder="e.g. 'Subscribe for Part 2', 'Link in Bio'...">
            </div>

            <!-- D. ADVANCED LOGIC -->
            <div class="section-title">D. Advanced (Smart Logic)</div>
            
            <div class="form-group">
                <label>10. Emotional Arc</label>
                <span class="helper">Leave on AUTO to derive from Formula.</span>
                <select id="emotionalArc">
                    <option value="AUTO" selected>‚ö° AUTO (Based on Formula)</option>
                    <option value="3-ACT">3-ACT (Setup-Conflict-Resolution)</option>
                    <option value="HEARTBEAT">HEARTBEAT (Fast-Slow-Fast)</option>
                    <option value="TRANSFORMATION">TRANSFORMATION (A ‚Üí B)</option>
                    <option value="INSIGHT">INSIGHT (Building to Aha!)</option>
                    <option value="TRAGEDY/EMPATHY">TRAGEDY/EMPATHY (Hope-Fall)</option>
                    <option value="COURAGE">COURAGE (Fear-Action-Triumph)</option>
                    <option value="CURIOSITY LOOP">CURIOSITY LOOP (Questions...)</option>
                    <option value="MYSTERY ARC">MYSTERY ARC (Escalation)</option>
                    <option value="ABSURDITY">ABSURDITY (Logical to Illogical)</option>
                    <option value="REVERSE">REVERSE (Flip Expectation)</option>
                    <option value="GRATITUDE">GRATITUDE (Lack to Appreciation)</option>
                    <option value="LEGACY">LEGACY (Past-Present-Future)</option>
                    <option value="CONNECTION">CONNECTION (Isolation to Belonging)</option>
                </select>
            </div>

            <div class="form-group">
                <label>11. Retention Strategy</label>
                <span class="helper">Leave on AUTO to derive from Duration/Formula.</span>
                <select id="retention">
                    <option value="AUTO" selected>‚ö° AUTO (Smart Selection)</option>
                    <option value="Click-Feedback Structure">Click-Feedback (5s validation)</option>
                    <option value="Curiosity Loop">Curiosity Loop (Mystery)</option>
                    <option value="Pattern Interrupt">Pattern Interrupt (Visual change)</option>
                    <option value="Sequential Reveal">Sequential Reveal (Layers)</option>
                    <option value="End-Loaded Payoff">End-Loaded Payoff (Best last)</option>
                    <option value="Bonus-Reveal">Bonus-Reveal (Surprise)</option>
                    <option value="Hard CTA Minimal Outro">Hard CTA Minimal Outro</option>
                    <option value="Curiosity Cliffhanger">Curiosity Cliffhanger</option>
                    <option value="Promise Breadcrumbs">Promise Breadcrumbs</option>
                    <option value="Reward Forecasting">Reward Forecasting</option>
                    <option value="Emotional Payoff Cascade">Emotional Payoff Cascade</option>
                </select>
            </div>

            <!-- E. BRAND & ASSETS (AGENCY MODULE) -->
            <div class="section-title">E. Brand & Assets (Ad Agency)</div>

            <div class="form-group">
                <label>12. Client/Brand Name</label>
                <input type="text" id="brandName" placeholder="e.g. 'Nike Indonesia', 'Gojek'...">
            </div>

            <div class="form-group">
                <label>13. Industry Category</label>
                <select id="industry">
                    <option value="">-- Select Industry --</option>
                    <option value="FMCG">FMCG (Food, Beverage, Consumer Goods)</option>
                    <option value="Tech">Technology & Electronics</option>
                    <option value="Automotive">Automotive</option>
                    <option value="Fashion">Fashion & Beauty</option>
                    <option value="Finance">Finance & Banking</option>
                    <option value="Pharma">Pharmaceutical & Healthcare</option>
                    <option value="Real Estate">Real Estate & Property</option>
                    <option value="E-commerce">E-commerce & Retail</option>
                    <option value="Telco">Telecommunications</option>
                    <option value="Custom">Custom / Lainnya...</option>
                </select>
                <input type="text" id="industryCustom" class="custom-input" style="display:none" placeholder="Isi kategori industri...">
            </div>

            <div class="form-group">
                <label>14. Product Name & Description</label>
                <input type="text" id="productName" placeholder="Product name...">
                <textarea id="productDesc" placeholder="Key features, USP, price positioning..." style="margin-top:8px; min-height:60px;"></textarea>
            </div>

            <div class="form-group">
                <label>15. Asset Upload (Optional)</label>
                <span class="helper">Upload produk/talent photos. AI will simulate asset intelligence.</span>
                
                <div style="margin-top:10px">
                    <label style="font-size:12px; font-weight:500">Product Photo:</label>
                    <div class="file-wrapper">
                        <input type="file" id="productPhoto" accept="image/*">
                        <button type="button" id="clearProduct" class="clear-btn" title="Hapus foto">‚úï</button>
                    </div>
                    <span class="helper" style="margin-top:4px">If provided, AI will be instructed to match its lighting & style.</span>
                </div>
                
                <div style="margin-top:10px">
                    <label style="font-size:12px; font-weight:500">Talent/Model Photo:</label>
                    <div class="file-wrapper">
                        <input type="file" id="talentPhoto" accept="image/*">
                        <button type="button" id="clearTalent" class="clear-btn" title="Hapus foto">‚úï</button>
                    </div>
                    <span class="helper" style="margin-top:4px">If provided, AI will extract visual characteristics.</span>
                </div>
            </div>

            <div class="form-group">
                <label>16. Brand Mandatories</label>
                <textarea id="mandatories" placeholder="e.g.&#10;- Logo placement: Bottom right, last 5s&#10;- Legal copy: '*T&C apply'&#10;- Color palette: Red #FF0000, White #FFFFFF" style="min-height:80px"></textarea>
            </div>

            <div class="form-group">
                <label>17. Content Policy Mode</label>
                <select id="policyMode">
                    <option value="" selected>-- Select Policy (Optional) --</option>
                    <option value="SAFE">Safe - AI Generation Ready (No celebrity likeness)</option>
                    <option value="FLEXIBLE">Flexible - Flagged but Allowed (Client approval needed)</option>
                    <option value="UNRESTRICTED">Unrestricted - Full Creative Freedom (Human production)</option>
                </select>
            </div>

            <div class="form-group">
                <label>18. Campaign Template (Speed Boost)</label>
                <span class="helper">Auto-fill formula based on campaign type.</span>
                <select id="campaignTemplate">
                    <option value="NONE">None (Build from scratch)</option>
                    <option value="PRODUCT_LAUNCH">Product Launch (New Market Entry)</option>
                    <option value="TESTIMONIAL">Testimonial (Social Proof & Trust)</option>
                    <option value="DEMO">Product Demo (Feature Showcase)</option>
                    <option value="BRAND_STORY">Brand Story (Mission & Values)</option>
                    <option value="SOCIAL_IMPACT">Social Impact (Community & CSR)</option>
                    <option value="COMPARISON">Comparison (Market Superiority)</option>
                    <option value="Custom">Custom Campaign...</option>
                </select>
                <input type="text" id="campaignCustom" class="custom-input" style="display:none" placeholder="Isi nama campaign...">
            </div>

        </div>

        <!-- RESIZER -->
        <div class="resizer" id="resizer"></div>

        <!-- RIGHT OUTPUT -->
        <div class="output-section">
            <div class="view-toggle">
                <button class="view-btn active" onclick="switchView('brief')">Preview</button>
                <button class="view-btn" onclick="switchView('prompt')">Full Prompt</button>
            </div>

            <div class="output-box">
                <!-- BRIEF VIEW -->
                <div id="briefView" class="brief-content"></div>
                <!-- PROMPT VIEW -->
                <div id="promptView" class="prompt-content"></div>
            </div>

            <div class="action-bar">
                <button class="btn btn-primary" id="smartCopyBtn" onclick="smartCopy()">
                    <span>Copy</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- SMART LOGIC MAPS ---
        const arcDefaults = {
            'WOW‚ÄìHOW‚ÄìNOW': 'INSIGHT',
            'Before‚ÄìAfter‚ÄìWhy': 'TRANSFORMATION',
            'Problem‚ÄìAction‚ÄìResult': '3-ACT',
            'Myth‚ÄìFact‚ÄìLesson': 'INSIGHT',
            'Top-X Curiosity Loop': 'CURIOSITY LOOP',
            'RANT / OPINION': 'COURAGE',
            'Twist‚ÄìReveal‚ÄìReflect': 'MYSTERY ARC',
            'Question‚ÄìChase‚ÄìAnswer': 'CURIOSITY LOOP',
            'Mystery‚ÄìClue‚ÄìTruth': 'MYSTERY ARC',
            'Hook‚ÄìProof‚ÄìPromise': 'INSIGHT',
            'Fact‚ÄìEmotion‚ÄìHope': 'TRAGEDY/EMPATHY',
            'Contrast‚ÄìPain‚ÄìChange': 'TRANSFORMATION',
            'Vision‚ÄìObstacle‚ÄìBreakthrough': 'COURAGE',
            'Chaos‚ÄìOrder‚ÄìPurpose': 'INSIGHT',
            'Fear‚ÄìAvoid‚ÄìAchieve': 'COURAGE',
            'Pattern‚ÄìBreak‚ÄìImpact': 'ABSURDITY',
            'OneName‚ÄìOneIdea‚ÄìOneChange': 'LEGACY',
            'TinyDetail‚ÄìBigTruth‚ÄìCuriosity': 'CURIOSITY LOOP',
            'HiddenOrigin‚ÄìModernImpact‚ÄìHumanMeaning': 'LEGACY'
        };

        const campaignMap = {
            'PRODUCT_LAUNCH': 'Hook‚ÄìProof‚ÄìPromise',
            'TESTIMONIAL': 'Problem‚ÄìAction‚ÄìResult',
            'DEMO': 'Before‚ÄìAfter‚ÄìWhy',
            'BRAND_STORY': 'Vision‚ÄìObstacle‚ÄìBreakthrough',
            'SOCIAL_IMPACT': 'Fact‚ÄìEmotion‚ÄìHope',
            'COMPARISON': 'Contrast‚ÄìPain‚ÄìChange'
        };

        const campaignDisplayMap = {
            'NONE': '',
            'PRODUCT_LAUNCH': 'Product Launch',
            'TESTIMONIAL': 'Testimonial',
            'DEMO': 'Product Demo',
            'BRAND_STORY': 'Brand Story',
            'SOCIAL_IMPACT': 'Social Impact',
            'COMPARISON': 'Comparison'
        };

        const policyDisplayMap = {
            'SAFE': 'Safe - AI Generation Ready (No celebrity likeness)',
            'FLEXIBLE': 'Flexible - Flagged but Allowed (Client approval needed)',
            'UNRESTRICTED': 'Unrestricted - Full Creative Freedom (Human production)'
        };

        function getAutoRetention(durationVal, formulaVal) {
            if (formulaVal === 'RANT / OPINION') return 'Hard CTA Minimal Outro';
            if (formulaVal.includes('Mystery') || formulaVal.includes('Twist')) return 'Curiosity Cliffhanger';
            if (formulaVal.includes('Myth') || formulaVal.includes('Proof')) return 'Reward Forecasting';
            if (formulaVal.includes('Fact‚ÄìEmotion')) return 'Emotional Payoff Cascade';
            
            if (['15s', '30s'].includes(durationVal)) return 'Click-Feedback + Pattern Interrupt';
            if (['1m', '90s'].includes(durationVal)) return 'Curiosity Loop + Sequential Reveal';
            if (['3m', '5m'].includes(durationVal)) return 'Sequential Reveal + Promise Breadcrumbs';
            if (['8m', '10m', '15m+'].includes(durationVal)) return 'Emotional Payoff Cascade + End-Loaded';

            return 'Curiosity Loop';
        }

        // --- UI LOGIC ---
        let currentView = 'brief';

        const inputs = {
            topic: document.getElementById('topic'),
            duration: document.getElementById('duration'), durationCustom: document.getElementById('durationCustom'),
            format: document.getElementById('format'), formatCustom: document.getElementById('formatCustom'),
            language: document.getElementById('language'),
            audiencePreset: document.getElementById('audiencePreset'), audienceCustom: document.getElementById('audienceCustom'),
            voiceBase: document.getElementById('voiceBase'), voiceCustom: document.getElementById('voiceCustom'),
            toneFlavor: document.getElementById('toneFlavor'), toneCustom: document.getElementById('toneCustom'),
            storyFormula: document.getElementById('storyFormula'),
            formulaDetail: document.getElementById('formulaDetail'),
            cta: document.getElementById('cta'),
            emotionalArc: document.getElementById('emotionalArc'),
            retention: document.getElementById('retention'),
            // AGENCY INPUTS
            brandName: document.getElementById('brandName'),
            industry: document.getElementById('industry'), industryCustom: document.getElementById('industryCustom'),
            productName: document.getElementById('productName'),
            productDesc: document.getElementById('productDesc'),
            productPhoto: document.getElementById('productPhoto'),
            talentPhoto: document.getElementById('talentPhoto'),
            mandatories: document.getElementById('mandatories'),
            policyMode: document.getElementById('policyMode'),
            campaignTemplate: document.getElementById('campaignTemplate'), campaignCustom: document.getElementById('campaignCustom')
        };

        // BUTTONS FOR FILE CLEAR
        const btnClearProduct = document.getElementById('clearProduct');
        const btnClearTalent = document.getElementById('clearTalent');

        function toggleCustomInput(selectId, customId) {
            const sel = document.getElementById(selectId);
            const cust = document.getElementById(customId);
            cust.style.display = sel.value === 'Custom' ? 'block' : 'none';
        }

        inputs.campaignTemplate.addEventListener('change', function() {
            const selected = this.value;
            if (campaignMap[selected]) {
                inputs.storyFormula.value = campaignMap[selected];
                render();
            }
            toggleCustomInput('campaignTemplate', 'campaignCustom');
        });

        inputs.industry.addEventListener('change', function() {
            toggleCustomInput('industry', 'industryCustom');
        });

        // --- FILE UPLOAD LOGIC ---
        function handleFileSelect(inputId, btnId) {
            const input = document.getElementById(inputId);
            const btn = document.getElementById(btnId);
            if(input.files.length > 0) {
                btn.classList.add('visible');
            } else {
                btn.classList.remove('visible');
            }
            render();
        }

        function clearFile(inputId, btnId) {
            const input = document.getElementById(inputId);
            const btn = document.getElementById(btnId);
            input.value = ''; 
            btn.classList.remove('visible'); 
            render();
        }

        inputs.productPhoto.addEventListener('change', () => handleFileSelect('productPhoto', 'clearProduct'));
        inputs.talentPhoto.addEventListener('change', () => handleFileSelect('talentPhoto', 'clearTalent'));
        
        btnClearProduct.addEventListener('click', () => clearFile('productPhoto', 'clearProduct'));
        btnClearTalent.addEventListener('click', () => clearFile('talentPhoto', 'clearTalent'));


        function getData() {
            const getMulti = (sel, cust) => {
                let val = Array.from(sel.selectedOptions).map(o => o.value);
                if (cust.value) val.push(cust.value);
                return val.join(' + ');
            };
            const getSingle = (sel, cust) => {
                return sel.value === 'Custom' ? cust.value : sel.value;
            };

            const durasi = getSingle(inputs.duration, inputs.durationCustom);
            const formula = inputs.storyFormula.value;
            const formulaDet = inputs.formulaDetail.value;

            let arc = inputs.emotionalArc.value;
            if (arc === 'AUTO') {
                const derived = arcDefaults[formula] || '3-ACT';
                arc = `${derived} (Auto-Derived)`;
            }

            let retention = inputs.retention.value;
            if (retention === 'AUTO') {
                const derived = getAutoRetention(durasi, formula);
                retention = `${derived} (Auto-Selected)`;
            }

            let aud = inputs.audienceCustom.value || inputs.audiencePreset.value || 'General Audience';
            let voiceVal = getMulti(inputs.voiceBase, inputs.voiceCustom);
            if (!voiceVal || voiceVal === '') voiceVal = 'Default';

            const hasProduct = inputs.productPhoto.files.length > 0;
            const hasTalent = inputs.talentPhoto.files.length > 0;

            let rawCamp = inputs.campaignTemplate.value;
            let finalCamp = "";
            if (rawCamp === 'Custom') {
                finalCamp = inputs.campaignCustom.value;
            } else if (rawCamp !== 'NONE') {
                finalCamp = campaignDisplayMap[rawCamp] || rawCamp; 
            }

            let rawPolicy = inputs.policyMode.value;
            let finalPolicy = "";
            if (rawPolicy && rawPolicy !== "") {
                finalPolicy = policyDisplayMap[rawPolicy] || rawPolicy;
            }

            return {
                topic: inputs.topic.value || '[No Topic]',
                durasi: durasi,
                format: getSingle(inputs.format, inputs.formatCustom),
                lang: inputs.language.value,
                audience: aud,
                voice: voiceVal,
                tone: getMulti(inputs.toneFlavor, inputs.toneCustom) || 'Default',
                formula: formula,
                formulaDetail: formulaDet,
                cta: inputs.cta.value.trim(), 
                arc: arc,
                retention: retention,
                brandName: inputs.brandName.value || '',
                industry: getSingle(inputs.industry, inputs.industryCustom) || '',
                productName: inputs.productName.value || '',
                productDesc: inputs.productDesc.value || '',
                hasProduct: hasProduct,
                hasTalent: hasTalent,
                mandatories: inputs.mandatories.value || '',
                policyMode: finalPolicy,
                campaignTemplate: finalCamp
            };
        }

        // --- RENDER FUNCTION ---
        let currentValidItems = [];

        function render() {
            const data = getData();
            
            // Core Items
            let briefItems = [
                { label: 'Topic', val: data.topic },
                { label: 'Duration', val: data.durasi },
                { label: 'Format', val: data.format },
                { label: 'Language', val: data.lang },
                { label: 'Audience', val: data.audience },
                { label: 'Voice', val: data.voice },
                { label: 'Tone', val: data.tone },
                { label: 'Formula', val: data.formula, detail: data.formulaDetail }, 
                { label: 'CTA', val: data.cta },
                { label: 'Arc', val: data.arc },
                { label: 'Retention', val: data.retention }
            ];

            // Agency Items
            let brandVal = data.brandName;
            if (data.industry) brandVal += ` (${data.industry})`;
            
            // --- STRICT ASSET LOGIC ---
            let assetVal = "";
            if (data.hasProduct || data.hasTalent) {
                const prodStr = data.hasProduct ? "Product: Uploaded (Simulate Intelligence)" : "Product: No";
                const talentStr = data.hasTalent ? "Talent: Uploaded (Extract Characteristics)" : "Talent: No";
                assetVal = `${prodStr}, ${talentStr}`;
            } 
            
            briefItems.push(
                { label: '---', val: '---' }, // Separator
                { label: 'Brand', val: brandVal.trim() },
                { label: 'Campaign', val: data.campaignTemplate },
                { label: 'Product', val: data.productName },
                { label: 'Details', val: data.productDesc },
                { label: 'Mandatories', val: data.mandatories },
                { label: 'Assets', val: assetVal }
            );

            if (data.policyMode && data.policyMode !== "") {
                briefItems.push({ label: 'Policy', val: data.policyMode });
            }

            // Filter
            currentValidItems = briefItems.filter(item => {
                if (item.label === 'Topic') return true; 
                if (item.label === '---') return true; 
                if (!item.val || item.val === '' || item.val === '-') return false;
                if (item.label === 'Format' && item.val === 'Undecided') return false;
                return true;
            });

            // Remove sep if last
            const sepIndex = currentValidItems.findIndex(i => i.label === '---');
            if (sepIndex === currentValidItems.length - 1) {
                currentValidItems.pop();
            }

            // --- STRICT NUMBERING LOGIC ---
            const briefHTML = currentValidItems.map((item, index) => {
                if (item.label === '---') {
                    return `<div style="border-bottom: 2px dashed #e0e0e0; margin: 15px 0;"></div>`;
                }

                let detailHtml = '';
                if (item.label === 'Formula' && item.detail) {
                    detailHtml = `<div class="detail-block">${item.detail}</div>`;
                }
                
                // Kunci: Hanya nomori item sebelum separator '---'
                let displayIndex = '';
                if (sepIndex === -1 || index < sepIndex) {
                    // Ini bagian Top (Core), pakai nomor 1-11
                    displayIndex = (index + 1) + '. ';
                } else {
                    // Ini bagian Bawah (Agency), tidak pakai nomor/bullet
                    displayIndex = ''; 
                }

                return `<div class="brief-item"><div class="brief-key">${displayIndex}${item.label}</div><div class="brief-val">${item.val}${detailHtml}</div></div>`;
            }).join('');
            
            document.getElementById('briefView').innerHTML = briefHTML;


            // Full Prompt
            let visualInstruction = "";
            if (data.format === 'Undecided') {
                visualInstruction = `*FORMAT NOTE:* User has NOT decided the format yet. Please suggest the best video format based on the Topic.`;
            } else if (data.format.toLowerCase().includes("audio") || data.format.toLowerCase().includes("podcast")) {
                visualInstruction = `*FORMAT NOTE:* AUDIO-ONLY format (${data.format}). Do NOT write visual descriptions. Focus on Sound Design (SFX) & Ambience.`;
            } else if (data.format.toLowerCase().includes("script only")) {
                visualInstruction = `*FORMAT NOTE:* Text script only. No visual/audio cues needed.`;
            } else {
                visualInstruction = `*FORMAT NOTE:* VIDEO format (${data.format}). Provide visual descriptions suitable for this style.`;
            }

            let agencyContext = "";
            if (data.brandName || data.productName || data.mandatories) {
                agencyContext = `
## üè¢ BRAND & AGENCY DATA
- **Brand/Client:** ${data.brandName || '-'}
- **Industry:** ${data.industry || '-'}
- **Campaign Type:** ${data.campaignTemplate || '-'}
- **Product:** ${data.productName || '-'}
- **Description/USP:** ${data.productDesc || '-'}
- **Mandatories:** ${data.mandatories || '-'}
- **Assets Status:**
  - Product Photo: ${data.hasProduct ? 'Uploaded' : 'None'}
  - Talent Photo: ${data.hasTalent ? 'Uploaded' : 'None'}
`;
            }

            let assetInstruction = "";
            if (data.hasProduct) {
                assetInstruction += `*ASSET NOTE:* User uploaded a Product Photo. Please derive visual characteristics (lighting, materials, colors) from the context provided or assume high-end studio photography matching the industry standard.\n`;
            }
            if (data.hasTalent) {
                assetInstruction += `*TALENT NOTE:* User uploaded a Talent Photo. AI should extract character features (age, style, vibe) to describe the protagonist accurately.\n`;
            }

            let policyInstruction = "";
            if (data.policyMode && data.policyMode !== "") {
                policyInstruction = `
### F. CONTENT POLICY
**COMMAND:** Adhere to the selected Content Policy Mode: **[${data.policyMode}]**
`;
            }

            let ctaInstruction = data.cta 
                ? `Ensure the script builds up to this CTA: "${data.cta}"` 
                : `No specific CTA provided. End the script naturally.`;

            const contextList = currentValidItems
                .filter(i => i.label !== '---')
                .map((item, index) => {
                    let valStr = item.val;
                    if (item.label === 'Formula' && item.detail) {
                        valStr += `\n   ${item.detail.split('\n').join('\n   ')}`;
                    }
                    return `${item.label.toUpperCase()}: ${valStr}`;
                }).join('\n');

            const masterPrompt = `
# üìù SCRIPT GENERATOR

## CONTEXT
${contextList}
${agencyContext}

---

## EXECUTION INSTRUCTIONS

### A. FORMAT & VISUAL LOGIC
${visualInstruction}
${assetInstruction}

### B. WORD COUNT & PACING
Calculate target word count based on [Duration] and [Voice]:
- High Energy: ~3 words/sec
- Conversational: ~2.5 words/sec
- Slow/Deep: ~1.8 words/sec
*Constraint:* Must fit the duration.

### C. LANGUAGE & REGISTER (Indonesian Logic)
**IF LANGUAGE = INDONESIAN:**
1. **Localization:** Don't translate slang literally. Use local equivalents (e.g. "Jujurly", "Valid").
2. **Particles:** Use (Lah/Dong/Sih/Kok) naturally.
3. **Register Hierarchy:**
   - Gen Z/Youth = Slang/Lo-Gue/Mixed.
   - General Public = Conversational (Aku/Kamu/Kita).
   - Professional = Baku/Standard.
   *Override:* Even if Voice is "News", if Audience is "Gen Z", use Gen Z vocabulary with News delivery.

### D. ENDING LOGIC
${ctaInstruction}
${policyInstruction}

### E. OUTPUT
Produce the final script with tags [EMOTION, SPEED] for TTS/Voiceover.
`.trim();

            document.getElementById('promptView').textContent = masterPrompt;
        }

        function switchView(mode) {
            currentView = mode;
            document.getElementById('briefView').style.display = mode === 'brief' ? 'block' : 'none';
            document.getElementById('promptView').style.display = mode === 'prompt' ? 'block' : 'none';
            
            const btn = document.getElementById('smartCopyBtn');
            const btns = document.querySelectorAll('.view-btn');
            btns.forEach(b => b.classList.remove('active'));
            
            if (mode === 'brief') {
                btns[0].classList.add('active');
                btn.innerHTML = '<span>Copy</span>';
            } else {
                btns[1].classList.add('active');
                btn.innerHTML = '<span>Copy Prompt</span>';
            }
        }

        function smartCopy() {
            let textToCopy = "";
            if (currentView === 'brief') {
                const sepIndex = currentValidItems.findIndex(i => i.label === '---');
                
                textToCopy = currentValidItems.map((item, index) => {
                    if (item.label === '---') return "-------------------------";
                    let valStr = item.val;
                    if (item.label === 'Formula' && item.detail) {
                        valStr += `\n${item.detail}`;
                    }
                    
                    let displayIndex = '';
                    if (sepIndex === -1 || index < sepIndex) {
                        displayIndex = (index + 1) + '. ';
                    }
                    
                    return `${displayIndex}${item.label}: ${valStr}`;
                }).join('\n');
            } else {
                textToCopy = document.getElementById('promptView').textContent;
            }

            navigator.clipboard.writeText(textToCopy).then(() => {
                const btn = document.getElementById('smartCopyBtn');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<span>Copied</span>';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.classList.remove('copied');
                }, 1500);
            });
        }

        ['duration', 'format'].forEach(id => {
            document.getElementById(id).addEventListener('change', () => toggleCustomInput(id, id+'Custom'));
        });

        Object.values(inputs).forEach(el => {
            if(el) {
                el.addEventListener('input', render);
                el.addEventListener('change', render);
            }
        });

        const resizer = document.getElementById('resizer');
        const leftPane = document.getElementById('leftPane');
        let x = 0; let w = 0;
        resizer.addEventListener('mousedown', e => {
            x = e.clientX; w = leftPane.getBoundingClientRect().width;
            document.addEventListener('mousemove', resizeMove);
            document.addEventListener('mouseup', resizeUp);
        });
        function resizeMove(e) { 
            const newW = w + e.clientX - x;
            if (newW > 300 && newW < window.innerWidth * 0.8) leftPane.style.width = newW + 'px'; 
        }
        function resizeUp() { document.removeEventListener('mousemove', resizeMove); document.removeEventListener('mouseup', resizeUp); }

        render();

    </script>
</body>
</html>
